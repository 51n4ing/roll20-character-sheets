<div class="sheet-main">
	
	<!-- To switch tabs -->
	
	<input type='hidden' class='sheet-tabstoggle' name='attr_sheetTab'  value='protagonist'  />

	<div class="sheet-main-top">
		
		<div class="sheet-tabselector">
			<h1> DREAMS and MACHINES</h1>
			<span> </span>
			<button type="action" name="act_protagonist" class="sheet-tabbutton" >Protagonist</button> <span> </span> <button type="action" name="act_npc" class="sheet-tabbutton" >NPC</button>
		
		</div>
	</div>
	
	<!-- PC character sheet -->
	
	<div class="sheet-main-protagonist">
	
		<!-- Infomation fields for the PCs -->
		
		<div class="sheet-pcinfo">		
			<label class="sheet-left-label">Name</label> <input name="attr_character_name" class="sheet-char-inputs" type="text"/>			
			<label class="sheet-left-label">Pronouns</label> <input name="attr_pronouns" class="sheet-char-inputs" type="text" />			
		</div>

		<!-- Attributes -->
		
		<div class="sheet-attributes">			
			<label class="sheet-left-label">Attributes</label> 			
			<button type="action" name="act_might" class="sheet-selectbutton" >A</button> <label class="sheet-middle-label" title="represents a characters physical strength and endurance, and their knowledge of how best to use those qualities effectively. Mighty characters tend to be good at climbing, swimming, hand-to-hand combat, operating heavy equipment, lifting heavy loads, and breaking things." >Might</label> <input name="attr_might" class="sheet-stat-inputs" type="number" value="4" /> 
			<button type="action" name="act_quickness" class="sheet-selectbutton" >A</button> <label class="sheet-middle-label" title="represents a characters coordination, dexterity, reflexes, speed, and agility, as well as an understanding of how to apply those qualities in practice. Quick characters tend to be good at running, jumping, sneaking, feats of acrobatics, avoiding physical hazards, delicate or precise technical work, and responding rapidly to new circumstances." >Quickness</label> <input name="attr_quickness" class="sheet-stat-inputs" type="number" value="4" /> 			
			<button type="action" name="act_insight" class="sheet-selectbutton" >A</button> <label class="sheet-middle-label" title= "represents a characters ability to understand new information, piece together clues, notice unusual details, make intuitive leaps, and generally comprehend and apply knowledge. Insightful characters are clever, observant, and knowledgeable." >Insight</label> <input name="attr_insight" class="sheet-stat-inputs" type="number" value="4" /> 			
			<button type="action" name="act_resolve" class="sheet-selectbutton" >A</button> <label class="sheet-middle-label" title="represents a characters ability to resist coercion, to remain focused when scared, stressed, or debilitated by pain or doubt, or to command attention. Resolute characters tend to have a potent force of personality, and may come across as persuasive or compelling, but they’re also stalwart and determined, able to keep a calm head during stressful situations." >Resolve</label> <input name="attr_resolve" class="sheet-stat-inputs" type="number" value="4" />  			
		</div>
		
		<!-- Spirit Pool -->
		
		<div class="sheet-spiritpool">			
			<label class="sheet-left-label">Spirt Pool</label> 			
			<label class="sheet-left-label">Curr</label> <input name="attr_currspirit" class="sheet-char-inputs" type="number" value="0" />			
			<label class="sheet-left-label">Max</label> <input name="attr_maxspirit" class="sheet-char-inputs" type="number" value="0" />			
		</div>

		<!-- Coin -->
		
		<div class="sheet-coin">			
			<label class="sheet-left-label">Coin</label> <input name="attr_coin" class="sheet-char-inputs" type="number" value="0" />		
		</div>

		<!-- Tech Level -->
		
		<div class="sheet-techlevel">			
			<label class="sheet-left-label">Tech Level</label> <input name="attr_techlevel" class="sheet-char-inputs" type="number" value="0" />			
		</div>

		<!-- Supply Points -->
		
		<div class="sheet-supplypoints">			
			<label class="sheet-left-label">Supply Points</label> <input name="attr_supplypoints" class="sheet-char-inputs" type="number" value="0" />			
		</div>

		<!-- Growth -->
		
		<div class="sheet-growth">			
			<label class="sheet-left-label">Growth</label> <input name="attr_growth" class="sheet-char-inputs" type="number" value="0" />			
		</div>

		<!-- Skills -->
		
		<div class="sheet-skills">			
			<label class="sheet-left-label">Skills</label> 			
			<button type="action" name="act_fight" class="sheet-selectbutton" >B</button> <label class="sheet-middle-label" title="covers attempting to inflict or avoid harm, as well as the tricks, tactics, and techniques of combat." >Fight</label> <input name="attr_fight" class="sheet-stat-inputs" type="number" value="1" /> 			
			<button type="action" name="act_move" class="sheet-selectbutton" >B</button> <label class="sheet-middle-label" title= "covers traversing an environment, by running, climbing, swimming, jumping, and other methods. It can also include identifying a route through difficult or dangerous terrain, and guiding others through it." >Move</label> <input name="attr_move" class="sheet-stat-inputs" type="number" value="1" /> 			
			<button type="action" name="act_operate" class="sheet-selectbutton" >B</button> <label class="sheet-middle-label" title="overs using, maintaining, and fixing tools and machines. This skill is the one most affected by the character’s Tech Level " >Operate</label> <input name="attr_operate" class="sheet-stat-inputs" type="number" value="1" /> 			
			<button type="action" name="act_sneak" class="sheet-selectbutton" >B</button> <label class="sheet-middle-label" title="covers actions taken in such a way as to avoid notice, such as moving quietly and hiding, as well as performing subtle or clandestine actions such as using camouflage, picking locks, bypassing security systems and traps, picking pockets, and creating effective distractions to mislead or confuse adversaries." >Sneak</label> <input name="attr_sneak" class="sheet-stat-inputs" type="number" value="1" /> 			
			<button type="action" name="act_study" class="sheet-selectbutton" >B</button> <label class="sheet-middle-label" title="covers the ability to gain information through observation and investigation. This can include research of ancient books and data from old computers, as well as learning about creatures, machines, and situations by carefully watching them." >Study</label> <input name="attr_study" class="sheet-stat-inputs" type="number" value="1" /> 			
			<button type="action" name="act_survive" class="sheet-selectbutton" >B</button> <label class="sheet-middle-label" title="covers how to effectively stay alive in the wilderness, helping when a character wishes to gather food and other resources in the wild, to avoid exposure to extreme weather and other environmental conditions, and to navigate using natural landmarks, stars, and other signs. It also covers more short-term survival, such as resisting poisons, diseases, and other debilitating effects, and how to treat Injuries." >Survive</label> <input name="attr_survive" class="sheet-stat-inputs" type="number" value="1" /> 			
			<button type="action" name="act_talk" class="sheet-selectbutton" >B</button> <label class="sheet-middle-label" title="covers how to interact with other people, to convey complex ideas effectively, or to use emotive language to inspire or coerce. This also includes a knowledge of these techniques, and an ability to notice when theyre being used to manipulate or deceive." >Talk</label> <input name="attr_talk" class="sheet-stat-inputs" type="number" value="1" /> 						
		</div>

		<!-- Truths -->
		
		<div class="sheet-truths">			
			<label class="sheet-left-label">Character Truths</label> 		
			<label class="sheet-left-label">Origin</label> <input name="attr_archetype" class="sheet-char-inputs" type="text" />			
			<label class="sheet-left-label">Archetype</label> <input name="attr_archetype" class="sheet-char-inputs" type="text" />			
			<!-- Other Truths -->
			<div class="sheet-truths">
				<fieldset class="repeating_truths">
					<div class="sheet-truths-row">
						<input name="attr_truthname" class="sheet-name-inputs" type="text" />
					</div>
				</fieldset>
			</div>
			<label class="sheet-left-label">Temperament</label> <input name="attr_temperament" class="sheet-char-inputs" type="text" />			
		</div>

		<!-- Goals -->
		
		<div class="sheet-goals">			
			<label class="sheet-left-label">Goals</label> 
			<label class="sheet-left-label">Short Term</label> 
			<div class="sheet-shortgoals">
				<fieldset class="repeating_shortgoals">
					<div class="sheet-shortgoals-row">
						<input name="attr_goalname" class="sheet-name-inputs" type="text" />
					</div>
				</fieldset>
			</div>
			<label class="sheet-left-label">Long Term</label> 
			<div class="sheet-longgoals">
				<fieldset class="repeating_longgoals">
					<div class="sheet-longgoals-row">
						<input name="attr_goalname" class="sheet-name-inputs" type="text" />
					</div>
				</fieldset>
			</div>			
		</div>

		<!-- Bonds -->
		
		<div class="sheet-bonds">			
			<label class="sheet-left-label">Bonds</label> 
			<div class="sheet-bonds">
				<fieldset class="repeating_bonds">
					<div class="sheet-bonds-row">
						<input name="attr_bondname" class="sheet-name-inputs" type="text" />
						<input name="attr_bondtype" class="sheet-name-inputs" type="text" />
					</div>
				</fieldset>
			</div>			
		</div>

		<!-- Hartms -->
		
		<div class="sheet-harms">			
			<label class="sheet-left-label">Harms</label> 
			<div class="sheet-harms">
				<fieldset class="repeating_harms">
					<div class="sheet-harms-row">
						<input name="attr_harmname" class="sheet-name-inputs" type="text" />
					</div>
				</fieldset>
			</div>	
		</div>

		<!-- Talents -->
		
		<div class="sheet-talents">		
			<span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <h2 class="sheet-left-title">Talents</h2></span> 
			<span> </span>			
			<fieldset class="repeating_talents">
			    <div class="sheet-talents-row">
					<input name="attr_talentname" class="sheet-name-inputs" type="text" />
					<span> &nbsp;  <label class="sheet-left-label-small">Condition</label> &nbsp; </span>
					<input name="attr_talentcondition" class="sheet-talent-inputs" type="text" />
					<span> &nbsp;  <label class="sheet-left-label-small">Benefit</label> &nbsp; </span>
					<input name="attr_talentbenefit" class="sheet-talent-inputs" type="text" /> &nbsp; 
					<button type="roll" name="act_talentuse" class="sheet-usebutton" value="&{template:DreamsandMachinestalent}{{name=@{character_name}}}{{talent=@{talentname}}}{{condition=@{talentcondition}}}{{benefit=@{talentbenefit}}}">Use</button>
					<div class="col" style="width: 100%; height: 4px;"></div>
			    </div>
			</fieldset>
		</div>
		
	<!-- Coin -->
	
	<div class="sheet-coin">
		
		<label class="sheet-left-label">Archtype Goal</label> <input name="attr_archetypegoal" class="sheet-char-inputs" type="text" />
			
		
	</div>

	<!-- Coin -->
	
	<div class="sheet-coin">
		
		<label class="sheet-left-label">Exhaustion</label> <input name="attr_exhaustion" class="sheet-char-inputs" type="text" />
		
		
	</div>

	<!-- Coin -->
	
	<div class="sheet-coin">
		
		<label class="sheet-left-label">Origin</label> <input name="attr_archetype" class="sheet-char-inputs" type="text" />

		<!-- Equipment -->
		
		
	</div>

	<!-- Coin -->
	
	<div class="sheet-coin">
		
		<div class="sheet-equipment">
		
			<span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <h2 class="sheet-left-title">Equipment</h2></span> 
			<span> </span>
			
			<fieldset class="repeating_equipment">
			    <div class="sheet-equipment-row">
					<input name="attr_equipname" class="sheet-name-inputs" type="text" />
					<span> &nbsp;  <label class="sheet-left-label-small">Description</label>  </span>
					<input name="attr_equipdescription" class="sheet-talent-inputs-extra-long" type="text" /> &nbsp; 
					<div class="col" style="width: 100%; height: 4px;"></div>
			    </div>
			</fieldset>

		</div>
		
		<!-- Spacing fix -->

		<div class="col" style="width: 100%; height: 10px;"></div>
		
		<!-- Weapons -->
		
		<div class="sheet-weapons">
		
			<span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <h2 class="sheet-left-title">Weapons</h2></span> 
			<span> </span>
			
			<fieldset class="repeating_weapons">
			    <div class="sheet-weapons-row">
					<input name="attr_weaponname" class="sheet-name-inputs" type="text" />
					<span> &nbsp;  <label class="sheet-left-label-small">Damage &nbsp; &nbsp;  </label> &nbsp; </span>
					<input name="attr_weapondamage" class="sheet-char-inputs-short" type="number" value="0" />
					<span> &nbsp;  <label class="sheet-left-label-small">Qualities &nbsp; &nbsp; &nbsp;  </label> &nbsp; </span>
					<input name="attr_weaponqualities" class="sheet-talent-inputs-long" type="text" /> 
					<div class="col" style="width: 100%; height: 4px;"></div>
			    </div>
			</fieldset>

		</div>
		
		<!-- Spacing fix -->

		<div class="col" style="width: 100%; height: 10px;"></div>
		
		<!-- Focuses and 2d20 dice roller -->
		
		<div class="sheet-focuses">
			
			<span> </span> <h2 class="sheet-middle-title">Focuses</h2> <span> </span> <span> </span> <h2 class="sheet-middle-title"></h2> <span> </span> <span> </span> <h2 class="sheet-middle-title">2D20 Dice Roller</h2>
			
			<span> </span> <span> </span> <span> </span> <span> </span> <span> </span> <span> </span> <span> </span>  <span> </span>
			
			<span> <label class="sheet-left-label">1. Set Difficulty</label> <button type="action" name="act_difficulty0" class="sheet-selectbutton" >0</button> <button type="action" name="act_difficulty1" class="sheet-selectbutton" >1</button> <button type="action" name="act_difficulty2" class="sheet-selectbutton" >2</button> <button type="action" name="act_difficulty3" class="sheet-selectbutton" >3</button> <button type="action" name="act_difficulty4" class="sheet-selectbutton" >4</button> <button type="action" name="act_difficulty5" class="sheet-selectbutton" >5</button> </span>
			
			<span> <label class="sheet-left-label">2. Attributes</label>  </span>
			
			<span> &nbsp; &nbsp; <label class="sheet-left-label">A.</label> <input name="attr_attributea" class="sheet-readonly-inputs" type="text" readonly /> &nbsp; <label class="sheet-left-label"> + B.</label> <input name="attr_attributeb" class="sheet-readonly-inputs" type="text" readonly />  </span>
			
			<input type="hidden" name="attr_attributevala" value="0" readonly>
			<input type="hidden" name="attr_attributevalb" value="0" readonly>
			
			<span> &nbsp; &nbsp; <label class="sheet-left-label">C.</label> <input name="attr_attributec" class="sheet-readonly-inputs" type="text"  readonly /> &nbsp; <label class="sheet-left-label">TN</label> <input type="number" class="sheet-char-inputs-short" name="attr_targetnumber" value="[[@{attributevala}+@{attributevalb}]]" readonly disabled > &nbsp; <label class="sheet-left-label">FC</label> <input type="number" class="sheet-char-inputs-short" name="attr_focusnumber" value="[[@{attributevalc}]]" readonly disabled > </span>
			
			<input type="hidden" name="attr_attributevalc" value="0" readonly>
			
			<span> &nbsp; &nbsp; <label class="sheet-left-label">vs. difficulty</label> <input type="number" name="attr_difficulty" class="sheet-char-inputs-short" readonly> </span>
			
			<span> <label class="sheet-left-label">Current dice being rolled...</label>  </span>
			
			<input type="hidden" name="attr_dicetoroll" value="[[2+@{additionaldice}]]" readonly>
			
			<input type="hidden" name="attr_focusnumberactual" value="1">
			
			
			<span> &nbsp; &nbsp; <label class="sheet-left-label">2D20 +</label> <input type="number" name="attr_additionaldice" class="sheet-char-inputs-short" value="0" min="0" max="3" > &nbsp; <button type="roll" name="roll_rolldice" class="sheet-selectbutton-long" value="&{template:DreamsandMachinesroll}{{name=@{character_name}}}{{attributea=@{attributea}}}{{attributeb=@{attributeb}}}{{attributec=@{attributec}}}{{diff=@{difficulty}}}{{spentmomentum=@{additionaldice}}}{{result=[[@{dicetoroll}d20<@{targetnumber}cs<@{focusnumberactual}cf20]]}}" >Roll Dice!</button> </span>
			
		
		</div>
		
		<!-- Spacing fix -->

		<div class="col" style="width: 100%; height: 10px;"></div>
		
	</div>
	
	
	<!-- NPC character sheet -->
	
	<div class="sheet-main-npc">
	</div>

	
</div>



<!-- Roll Templates -->

<!-- Main 2D20 Roll Template -->

<rolltemplate class="sheet-rolltemplate-DreamsandMachinesroll">
    <div class="sheet-DreamsandMachines-container">
        <div class="sheet-DreamsandMachines-roll-header">
            <br> {{name}}
        </div>
        <div class="sheet-DreamsandMachines-type">
            {{attributea}} + {{attributeb}} <br>
			focus {{attributec}}
        </div>
        <div class="sheet-DreamsandMachines-dice">
            <br>
            Cost<BR>
			{{spentmomentum}} <br>  <br>
			Manually Count: <br>
			Extra Successes (green) <br>
			Complications (red) <br>
        </div>
        
		
		

        <div class="DreamsandMachines-roll-result">
            Difficulty: {{diff}}<br>
            Dice: {{result}}<BR>
            
        </div>
    </div>
</rolltemplate>


<rolltemplate class="sheet-rolltemplate-DreamsandMachinestalent">
    <div class="sheet-DreamsandMachines-talent-container">
        <div class="sheet-DreamsandMachines-talent-header">
			<br> {{name}}<p></p>
        </div>
        <div class="sheet-DreamsandMachines-talent-name">
            {{talent}}
        </div>
        <div class="sheet-DreamsandMachines-talent-desc">
            <b style="color:#868ac4">Condition</b><p></p> {{condition}}<p></p>
            <b style="color:#868ac4">Benefit</b><p></p> {{benefit}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-DreamsandMachinesitem">
    <div class="sheet-DreamsandMachines-item-container">
        <div class="sheet-DreamsandMachines-item-header">
			<br> {{name}}<p></p>
        </div>
        <div class="sheet-DreamsandMachines-item-name">
            {{item}}
        </div>
        <div class="sheet-DreamsandMachines-item-desc">
            <b style="color:#868ac4">Description</b><p></p> {{description}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-DreamsandMachinesbonecharm">
    <div class="sheet-DreamsandMachines-bonecharm-container">
        <div class="sheet-DreamsandMachines-bonecharm-header">
			<br> {{name}}<p></p>
        </div>
        <div class="sheet-DreamsandMachines-bonecharm-name">
            {{bonecharm}}
        </div>
        <div class="sheet-DreamsandMachines-bonecharm-desc">
            <b style="color:#868ac4">Type</b><p></p> {{type}}<p></p>
            <b style="color:#868ac4">Power</b><p></p> {{power}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-DreamsandMachinespower">
    <div class="sheet-DreamsandMachines-power-container">
        <div class="sheet-DreamsandMachines-power-header">
			<br> {{name}}<p></p>
        </div>
        <div class="sheet-DreamsandMachines-power-name">
            {{power}}
        </div>
        <div class="sheet-DreamsandMachines-power-desc">
            <b style="color:#868ac4">Mana Use Cost</b><p></p> {{manausecost}}<p></p>
            <b style="color:#868ac4">Power</b><p></p> {{powerdescription}}
        </div>
    </div>
</rolltemplate>

<rolltemplate class="sheet-rolltemplate-DreamsandMachinesspecialrule">
    <div class="sheet-DreamsandMachines-specialrule-container">
        <div class="sheet-DreamsandMachines-specialrule-header">
			<br> {{name}}<p></p>
        </div>
        <div class="sheet-DreamsandMachines-specialrule-name">
            {{specialrule}}
        </div>
        <div class="sheet-DreamsandMachines-specialrule-desc">
            <b style="color:#868ac4">Description</b><p></p> {{specialruledescription}}
        </div>
    </div>
</rolltemplate>



<script type="text/worker">

	//Buttons for Tabs
    const buttonlist = ["protagonist","npc"];
    buttonlist.forEach(button => {
        on(`clicked:${button}`, function() {
            setAttrs({
                sheetTab: button,
            });
        });
    });
	
	
on("clicked:difficulty0", function(){
    setAttrs({
        difficulty:0
    });
});
on("clicked:difficulty1", function(){
    setAttrs({
        difficulty:1
    });
});
on("clicked:difficulty2", function(){
    setAttrs({
        difficulty:2
    });
});
on("clicked:difficulty3", function(){
    setAttrs({
        difficulty:3
    });
});
on("clicked:difficulty4", function(){
    setAttrs({
        difficulty:4
    });
});
on("clicked:difficulty5", function(){
    setAttrs({
        difficulty:5
    });
});


const attributesa =["fight","move","study","survive","talk","tinker"];

attributesa.forEach(button => {
    on(`clicked:${button}`, function(){
        var attribname=button.substring(0,button.length);

        getAttrs([attribname,"attributevala"], function(values){
            var attribvalue=parseInt(values[attribname])||0;
			
			setAttrs({
				attributea:attribname,
                attributevala:attribvalue
			});
  
		});
    });
});

const attributesb =["boldly","carefully","cleverly","forcefully","quietly","swiftly"];

attributesb.forEach(button => {
    on(`clicked:${button}`, function(){
        var attribname=button.substring(0,button.length);

        getAttrs([attribname,"attributevalb"], function(values){
            var attribvalue=parseInt(values[attribname])||0;
			
			setAttrs({
				attributeb:attribname,
                attributevalb:attribvalue
			});
  
		});
    });
});

const attributesc =["focus1","focus2","focus3","focus4","focus5","focus6","focus7","focus8","focus9","focus10","focus11","focus12","focus13","focus14"];

attributesc.forEach(button => {
    on(`clicked:${button}`, function(){
        var attribname=button.substring(0,button.length);
		var attribdisplay=button + "_name";

        getAttrs([attribname,"attributevalc",attribdisplay], function(values){
            var attribvalue=parseInt(values[attribname])||0;
			var attribdisplayname=values[attribdisplay];
			var focusMax=Math.max(1,attribvalue);
			
			setAttrs({
				attributec:attribdisplayname,
                attributevalc:attribvalue,
				focusnumberactual:focusMax
			});
  
		});
    });
});




	
	
</script>
